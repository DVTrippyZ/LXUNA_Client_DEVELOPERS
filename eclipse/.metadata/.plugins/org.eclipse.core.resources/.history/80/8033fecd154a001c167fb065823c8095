package intent.modules.movement;

import java.util.ArrayList;

import org.lwjgl.input.Keyboard;

import intent.Client;
import intent.events.Event;
import intent.events.listeners.EventUpdate;
import intent.modules.Module;
import net.minecraft.client.entity.EntityOtherPlayerMP;
import net.minecraft.network.play.client.C01PacketChatMessage;

import net.minecraft.network.play.client.C03PacketPlayer;
import net.minecraft.network.AbstractPacket;


public class Blink extends Module{

	private EntityOtherPlayerMP oldPlayer;
	public static ArrayList<AbstractPacket> blinkList = new ArrayList<AbstractPacket>();
	public static boolean disabling = false;
	
	
	
	public void onEnable() {
		
		oldPlayer = new EntityOtherPlayerMP(mc.theWorld, mc.thePlayer.getGameProfile());

		oldPlayer.setPosition(mc.thePlayer.posX, mc.thePlayer.posY, mc.thePlayer.posZ);

		oldPlayer.rotationYawHead = mc.thePlayer.rotationYawHead;
		oldPlayer.clonePlayer(mc.thePlayer, true);
		oldPlayer.copyLocationAndAnglesFrom(mc.thePlayer);
		oldPlayer.rotationYaw = mc.thePlayer.rotationYaw;

		mc.theWorld.addEntityToWorld(-123, oldPlayer);
		
	}
	
	public void onDisable() {
		
		mc.theWorld.removeEntityFromWorld(-123);
		oldPlayer = null;
		disabling = true;
		for (AbstractPacket packet : blinkList) {
			sendPacketFinal(packet);
		}
		blinkList.clear();
		
		disabling = false;
		
	}
	
	
	public Blink() {
		super("Blink", Keyboard.KEY_NONE, Category.RENDER, "Y");
		
	}
	
	public void onEvent(Event e) {
		if(e instanceof EventUpdate) {
			if(e.isPre()) {
				if (oldPlayer == null) {
					return;
				}
			
//				oldPlayer.setSneaking(mc.thePlayer.isSneaking());
//				oldPlayer.setSprinting(mc.thePlayer.isSprinting());
//				oldPlayer.isSwingInProgress = mc.thePlayer.isSwingInProgress;
//				oldPlayer.swingProgress = mc.thePlayer.swingProgress;
//				oldPlayer.swingProgressInt = mc.thePlayer.swingProgressInt;
				
			}

		

			public static void packet(AbstractPacket packetIn) {
				blinkList.add(packetIn);
			}
			}
		}
	

}
